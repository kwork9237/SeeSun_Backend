<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.seesun.mapper.qna.LectureQnaMapper">

    <insert id="insertQuestion" parameterType="com.seesun.dto.lecture.LectureQnaDTO">
        INSERT INTO lecture_qna (le_id, mb_id, title, content)
        VALUES (#{leId}, #{mbId}, #{title}, #{content})
    </insert>

    <select id="getQnaListByLecture" resultType="com.seesun.dto.lecture.LectureQnaDTO">
        SELECT 
            q.*, 
            m.nickname as authorNickname  FROM lecture_qna q
        JOIN member m ON q.mb_id = m.mb_id
        WHERE q.le_id = #{leId}
        ORDER BY q.created_at DESC
    </select>

    <update id="updateAnswer">
        UPDATE lecture_qna
        SET 
            answer = #{answer},
            ans_mb_id = #{ansMbId},
            status = 1,
            modified_at = NOW()
        WHERE qna_id = #{qnaId}
    </update>

</mapper>