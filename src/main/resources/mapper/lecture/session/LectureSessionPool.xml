<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.seesun.mapper.lecture.session.LectureSessionPoolMapper">

	<!-- 할당되지 않은 Pool의 data를 가져옴 -->
	<select id="getPoolData" resultType="lectureSessionPool">
		SELECT * FROM lecture_session_pool
		WHERE status = 0
		ORDER BY room_id ASC
		LIMIT 1
		FOR UPDATE
	</select>

	<!-- Pool의 상태 업데이트 -->
	<update id="activateSessionByRoomId">
		UPDATE lecture_session_pool
		SET status = 1
		WHERE 
			room_id = #{room_id} AND
			status = 0
	</update>
	
	<update id="deactivateSessionByRoomId">
		UPDATE lecture_session_pool
		SET status = 0
		WHERE
			room_id = #{room_id} AND
			status = 1
	</update>
	
	<!-- url 리턴 -->
	<!-- 
	<select id="getUuidByRoomId">
		SELECT room_uuid FROM lecture_session_pool
		WHERE room_id = #{room_id}
	</select>
	 -->
</mapper>